//list all users
import java.sql.*;  // Using 'Connection', 'Statement' and 'ResultSet' classes in java.sql package
 
public class JdbcSelect {  
   public static void main(String[] args) {
      try (
         Connection conn = DriverManager.getConnection(
               "jdbc:mysql://localhost:3306/mydatebase?allowPublicKeyRetrieval=true&useSSL=false&serverTimezone=EDT",
               "myuser", "xxxx");   // For MySQL only
               // The format is: "jdbc:mysql://localhost:port/mydatabase", "username", "password"
 
         Statement stmt = conn.createStatement();
      ) {
         /
         String strSelect = "select user, password from Users";
         System.out.println("The SQL statement is: " + strSelect + "\n"); // Echo For debugging
 
         ResultSet rset = stmt.executeQuery(strSelect);
 
         System.out.println("The records selected are:");
         int rowCount = 0;
         while(rset.next()) {   // Move the cursor to the next row, return false if no more row
            String users = rset.getString("users");
            String password = rset.getDouble("password");
            System.out.println(users+ ", " + password);
            ++rowCount;
         }
         System.out.println("Total number of records = " + rowCount);
 
      } catch(SQLException ex) {
         ex.printStackTrace();
      }  
   }
}

//Update database
public class JdbcUpdate {  
   public static {
      try (
         // Step 1: Allocate a database 'Connection' object
         Connection conn = DriverManager.getConnection(
               "jdbc:mysql://localhost:3306/mydatabase?allowPublicKeyRetrieval=true&useSSL=false&serverTimezone=EDT",
               "myuser", "xxxx");    // for MySQL only
 
         Statement stmt = conn.createStatement();
      ) {
         String strUpdate = "update users set users = annabelle, where password = best";
         System.out.println("The SQL statement is: " + strUpdate + "\n");  // Echo for debugging
         int countUpdated = stmt.executeUpdate(strUpdate);
         System.out.println(countUpdated + " records affected.\n");
 
         String strSelect = "select * from Users where password = best";
         System.out.println("The SQL statement is: " + strSelect + "\n");  // Echo for debugging
         ResultSet rset = stmt.executeQuery(strSelect);
         while(rset.next()) {   // Move the cursor to the next row
            System.out.println(rset.getInt("user") + ", "
                    + rset.getString("password") + ", ";
         }
      } catch(SQLException ex) {
         ex.printStackTrace();
      }  
   }
}

//insert/delete users
public class JdbcInsert {    
   public static {
      try (
         Connection conn = DriverManager.getConnection(
               "jdbc:mysql://localhost:3306/mydatabase?allowPublicKeyRetrieval=true&useSSL=false&serverTimezone=EDT",
               "myuser", "xxxx"); // for MySQL only

         Statement stmt = conn.createStatement();
      ) {
         .
 
         // DELETE records with User=A and password=Pass
         String sqlDelete = "delete from books where id >= 3000 and id < 4000";
         System.out.println("The SQL statement is: " + sqlDelete + "\n");  // Echo for debugging
         int countDeleted = stmt.executeUpdate(sqlDelete);
         System.out.println(countDeleted + " records deleted.\n");
 
         // INSERT a record
         String sqlInsert = "insert into Users (33, 'KurtCobain', 'HiMom', 11)";
         System.out.println("The SQL statement is: " + sqlInsert + "\n");  // Echo for debugging
         int countInserted = stmt.executeUpdate(sqlInsert);
         System.out.println(countInserted + " records inserted.\n");

 
         // Issue a SELECT to check the changes
         String strSelect = "select * from Users";
         System.out.println("The SQL statement is: " + strSelect + "\n");  // Echo For debugging
         ResultSet rset = stmt.executeQuery(strSelect);
         while(rset.next()) {   // Move the cursor to the next row
            System.out.println(rset.getInt("users") + ", "
                    + rset.getString("passwords"));
         }
      } catch(SQLException ex) {
         ex.printStackTrace();
      }  
   }
}
